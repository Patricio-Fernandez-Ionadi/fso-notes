(this.webpackJsonpfront=this.webpackJsonpfront||[]).push([[0],{24:function(t,e,n){},45:function(t,e,n){"use strict";n.r(e);var r=n(1),c=n(19),o=n.n(c),a=(n(24),n(4)),i=n.n(a),u=n(8),s=n(10),l=n(3),j=n(0),b=function(t){var e=t.note,n=t.toggleImportance,r=e.important?"make not important":"make important";return Object(j.jsxs)("li",{className:"note",children:[e.content,Object(j.jsx)("button",{onClick:n,children:r})]})},d=function(t){var e=t.message;return null===e?null:Object(j.jsx)("div",{className:"error",children:e})},f=Object(r.forwardRef)((function(t,e){var n=t.children,c=t.buttonLabel,o=void 0===c?"Button":c,a=Object(r.useState)(!1),i=Object(l.a)(a,2),u=i[0],s=i[1],b={display:u?"none":"inherit"},d={display:u?"inherit":"none"},f=function(){return s(!u)};return Object(r.useImperativeHandle)(e,(function(){return{toggleVisibility:f}})),Object(j.jsxs)("div",{children:[Object(j.jsx)("div",{style:b,children:Object(j.jsx)("button",{onClick:f,children:o})}),Object(j.jsxs)("div",{style:d,children:[n,Object(j.jsx)("button",{onClick:f,children:"Cancel"})]})]})}));f.displayName="Toggable";var p=f,O=function(t){var e=t.logUser,n=Object(r.useState)(""),c=Object(l.a)(n,2),o=c[0],a=c[1],i=Object(r.useState)(""),u=Object(l.a)(i,2),s=u[0],b=u[1];return Object(j.jsx)(p,{buttonLabel:"Show Login",children:Object(j.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e({username:o,password:s}),a(""),b("")},children:[Object(j.jsx)("div",{children:Object(j.jsx)("input",{type:"text",value:o,name:"username",placeholder:"Username",onChange:function(t){var e=t.target;return a(e.value)}})}),Object(j.jsx)("div",{children:Object(j.jsx)("input",{type:"password",value:s,name:"password",placeholder:"Password",onChange:function(t){var e=t.target;return b(e.value)}})}),Object(j.jsx)("button",{id:"form-login-button",children:"Login"})]})})},h=function(t){var e=t.addNote,n=t.handleLogOut,c=Object(r.useState)(""),o=Object(l.a)(c,2),a=o[0],i=o[1],u=Object(r.useRef)();return Object(j.jsxs)(p,{buttonLabel:"New Note",ref:u,children:[Object(j.jsx)("h3",{children:"Create a new note"}),Object(j.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e({content:a,important:!1}),i(""),u.current.toggleVisibility()},children:[Object(j.jsx)("input",{value:a,onChange:function(t){var e=t.target;i(e.value)},placeholder:"Write your own note"}),Object(j.jsx)("button",{type:"submit",children:"save"})]}),Object(j.jsx)("div",{children:Object(j.jsx)("button",{onClick:n,children:"Logout"})})]})},v=n(5),g=n.n(v),m="/api/notes",x=null,w=function(){return g.a.get(m).then((function(t){return t.data}))},y=function(t){var e={headers:{Authorization:x}};return g.a.post(m,t,e).then((function(t){return t.data}))},S=function(t,e){var n={headers:{Authorization:x}};return g.a.put("".concat(m,"/").concat(t),e,n).then((function(t){return t.data}))},k=function(t){x="Bearer ".concat(t)},N=function(){var t=Object(u.a)(i.a.mark((function t(e){var n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.a.post("/api/login",e);case 2:return n=t.sent,r=n.data,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),C={login:N},L=function(){var t=Object(r.useState)([]),e=Object(l.a)(t,2),n=e[0],c=e[1],o=Object(r.useState)(!0),a=Object(l.a)(o,2),f=a[0],p=a[1],v=Object(r.useState)(null),g=Object(l.a)(v,2),m=g[0],x=g[1],N=Object(r.useState)(null),L=Object(l.a)(N,2),I=L[0],U=L[1];Object(r.useEffect)((function(){w().then((function(t){c(t)}))}),[]),Object(r.useEffect)((function(){var t=window.localStorage.getItem("loggedNoteAppUser");if(t){var e=JSON.parse(t);U(e),k(e.token)}}),[]);var A=function(){var t=Object(u.a)(i.a.mark((function t(e){var n,r,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.username,r=e.password,t.prev=1,t.next=4,C.login({username:n,password:r});case 4:c=t.sent,window.localStorage.setItem("loggedNoteAppUser",JSON.stringify(c)),k(c.token),U(c),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(1),x("Wrong credentials"),setTimeout((function(){x(null)}),5e3);case 14:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e){return t.apply(this,arguments)}}(),J=f?n:n.filter((function(t){return t.important}));return Object(j.jsxs)("div",{children:[Object(j.jsx)("h1",{children:"Notes"}),Object(j.jsx)(d,{message:m}),I?Object(j.jsx)(h,{addNote:function(t){y(t).then((function(t){c(n.concat(t))}))},handleLogOut:function(){U(null),k(null),window.localStorage.removeItem("loggedNoteAppUser")}}):Object(j.jsx)(O,{logUser:A}),Object(j.jsx)("div",{children:Object(j.jsxs)("button",{onClick:function(){return p(!f)},children:["show ",f?"important":"all"]})}),Object(j.jsx)("ul",{children:J.map((function(t,e){return Object(j.jsx)(b,{note:t,toggleImportance:function(){return function(t){var e=n.find((function(e){return e.id===t})),r=Object(s.a)(Object(s.a)({},e),{},{important:!e.important});console.log(e),console.log(r),S(t,r).then((function(e){c(n.map((function(n){return n.id!==t?n:e})))})).catch((function(t){x("Note '".concat(e.content,"' was already removed from server")),setTimeout((function(){x(null)}),5e3)}))}(t.id)}},e)}))})]})};o.a.render(Object(j.jsx)(L,{}),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.9fd91804.chunk.js.map